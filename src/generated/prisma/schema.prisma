datasource db {
  provider = "sqlite"
}

generator client {
  provider = "prisma-client-js"
  output   = "../src/generated/prisma"
}

enum SubscriptionState {
  DRAFT
  FULFILLING
  ACTIVE
  TERMINATED
}

model Product {
  id            String         @id @default(uuid())
  slug          String         @unique
  title         String
  coreAttribute String
  image         String
  rentalPlans   RentalPlan[]
  subscriptions Subscription[]
  createdAt     DateTime       @default(now())
}

model RentalPlan {
  id        String  @id @default(uuid())
  period    Int
  price     Int
  productId String
  product   Product @relation(fields: [productId], references: [id])

  @@unique([productId, period])
}

model Subscription {
  id                 String            @id @default(uuid())
  referenceId        String            @unique
  createdAt          DateTime          @default(now())
  updatedAt          DateTime          @updatedAt
  activatedAt        DateTime?
  activeUntil        DateTime
  terminatedAt       DateTime?
  terminationReason  String?
  terminationComment String?
  rentalPeriod       Int
  monthlyPrice       Int
  state              SubscriptionState
  productId          String
  product            Product           @relation(fields: [productId], references: [id])
}
